
#
#The code above reads the requested file from the safe directory.
#
#The code above does not check if the requested file is in the safe directory.
#
#The code above does not check if the requested file is a directory.
#
#The code above does not check if the requested file is a symbolic link.
#
#The code above does not check if the requested file is a hard link.
#
#The code above does not check if the requested file is a block device.
import os
import sys
import mimetypes
import posixpath
import urllib
import BaseHTTPServer
import SimpleHTTPServer
import cgi
import shutil
import subprocess
import re
import tempfile
import time
import threading
import traceback
import json
import socket
import base64
import hashlib
import urllib2
import urlparse
import random
import string
import ssl
import httplib
import glob
import fnmatch
import zipfile
import tarfile
import gzip
import bz2
import lzma
import zlib
import cStringIO
import Queue
import threading
import SocketServer
import BaseHTTPServer
import SimpleHTTPServer
import cgi
import shutil
import subprocess
import re
import tempfile
import time
import threading
import traceback
import json
import socket
import base64
import hashlib
import urllib2
import urlparse
import random
import string
import ssl
import httplib
import glob
import fnmatch
import zipfile
import tarfile
import gzip